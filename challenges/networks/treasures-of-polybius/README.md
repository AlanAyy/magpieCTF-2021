# Treasures of Polybius
### Category: Networking
### Author: Ethan Sengsavang (Petiole)

## Description
Rumours have been floating around that some data from the legendary Polybius
was leaked and has been circulating the internet for some time. After some
digging, these Google Drive links seem to have something of interest.

(Note: this requires downlading multiple large files, which can eat up internet
data usage and/or storage space. It is recommended to automate the searching
process)

```
https://drive.google.com/file/d/1GQwKov8tp9W9Ajnmp4vWXGfXPwi7uoeY/view?usp=sharing
https://drive.google.com/file/d/14AIFhz_IETRGcybih8s4JUs_FhW1Lm71/view?usp=sharing
https://drive.google.com/file/d/1_GWJ62MZISYG5xQuRGQY1OJ0d8ybKuE8/view?usp=sharing
https://drive.google.com/file/d/1wTo4bsOzUCi6dE01s3VQc8WjG9SPZwhT/view?usp=sharing
https://drive.google.com/file/d/10DkIlqOPahEHU6_u5-QhbeNvrEeesukY/view?usp=sharing
https://drive.google.com/file/d/1B5TVhSNoty58-hicHprD8ixz7ckhh5CT/view?usp=sharing
https://drive.google.com/file/d/1Ki1z4P7VTSeJ0wcwlHMZlEBRxteooxSi/view?usp=sharing
https://drive.google.com/file/d/1pJYfS-w6HwettnqKNnMNw07sG-AfekeP/view?usp=sharing
https://drive.google.com/file/d/1JemwA_MouSgVZ5GReX_kBW09MlEv84ZR/view?usp=sharing
https://drive.google.com/file/d/19fANuNOUT9Cdv6bcmBc675OxjkDnOab-/view?usp=sharing
https://drive.google.com/file/d/1YJy4n-RxTgt5LQuq4a4DNGmAvjpqXZsE/view?usp=sharing
https://drive.google.com/file/d/1AusrKWBT8fb6vl2mcbXlEtsZonzEsmGn/view?usp=sharing
https://drive.google.com/file/d/1VwGRo477UPAwIkkp8dpFctq8H25N-_xb/view?usp=sharing
https://drive.google.com/file/d/1mS0OyHVfpbC-Np1UnfwUAdkI4FU4X58E/view?usp=sharing
https://drive.google.com/file/d/1ZWkmDuM9cfaomZ3qUAABj37EdMXKJgEE/view?usp=sharing
https://drive.google.com/file/d/1Gy6aw9rKQD3SiEhi-H31Ykdsd9NoBjp5/view?usp=sharing
https://drive.google.com/file/d/1AQgmNH8y56jTJhSYhFZwUQLxmGnigK0l/view?usp=sharing
https://drive.google.com/file/d/11CqxPS4fpnYA799rhCw3SdjYoGFUwXdD/view?usp=sharing
https://drive.google.com/file/d/1_DITF6RvO1f5PBwzQfrvMsumhTpNFQ0Z/view?usp=sharing
https://drive.google.com/file/d/1t-gU97DyeWhUmoz6b47RUEQNxTijaCT-/view?usp=sharing
https://drive.google.com/file/d/1rMBjT4I4f0xb5yxNdCXK0jQipxbD2R5o/view?usp=sharing
https://drive.google.com/file/d/1ciBKaZq0gge5VrloSe0KoP0MoMKChjL5/view?usp=sharing
https://drive.google.com/file/d/1V7sEDJ4c1BnDuuzBaCLKFNYYeD4XP4a7/view?usp=sharing
https://drive.google.com/file/d/1ZM47NB0EzTuihW-I06kS6GWEn60Fei4u/view?usp=sharing
https://drive.google.com/file/d/1DVGqpywiDXr74FqVKHiAikQQeqgs-rEl/view?usp=sharing
https://drive.google.com/file/d/1BUGRfdiatIaQdBmv64UL_g3IJnRsNX98/view?usp=sharing
https://drive.google.com/file/d/1TKBoZfQSd1CY0w59Bh61cUW6nryHd1g1/view?usp=sharing
https://drive.google.com/file/d/18Kl1OOXPMIYq1SgeLh7coJj7jUdNpoZ6/view?usp=sharing
https://drive.google.com/file/d/1lT6usqzLuoncyHFpuyJn4dbKDQbQZjep/view?usp=sharing
https://drive.google.com/file/d/1XxlWD3uPsvyP77DeUO2VqazaYsVHHEzU/view?usp=sharing
https://drive.google.com/file/d/1qMQwWpuZPiJRi44_jNkzOgM6_dcgjMfB/view?usp=sharing
https://drive.google.com/file/d/1IvftRKj-e8CpjsLVVLxZv2FdXhNXVBkp/view?usp=sharing
https://drive.google.com/file/d/1ChWs1bwIIzwNVBGN8lr1plp0wfPzKe68/view?usp=sharing
https://drive.google.com/file/d/12-fkCGfHQ5SPGQDMzrtTjSvLiogWEzMI/view?usp=sharing
https://drive.google.com/file/d/1yZ_oJsSXOHg8yAGAg3xnpy50GlLww2CH/view?usp=sharing
https://drive.google.com/file/d/17mvYcIVHQ6fDXBrwZz2NOogyz-BIk-9y/view?usp=sharing
https://drive.google.com/file/d/1REt3C8N_776o_tMmz1m7SmQvSfWue_Gg/view?usp=sharing
https://drive.google.com/file/d/1HJgvQ5ibCzwzaJD7J5jsVFCicNHgZEmN/view?usp=sharing
https://drive.google.com/file/d/18H2ANLrtDb_Np4N-ZPupQ5Nb4VgjHb1Z/view?usp=sharing
https://drive.google.com/file/d/1qv3PrC9miGXW7zHXsA5bgtyH9p1VLc3X/view?usp=sharing
https://drive.google.com/file/d/17z5VYS547jGQ6wdhqrTPp9lN7gGMYG5H/view?usp=sharing
https://drive.google.com/file/d/1z-Qjf_KoyY8orDMLTYwDdLK6IqEdGvFh/view?usp=sharing
https://drive.google.com/file/d/10ngpgh3zxig5KvrwwomF8Dn-h_jHK9g6/view?usp=sharing
https://drive.google.com/file/d/1HhUEewjG0PnPcBe9YTzx7ZIg3iZYNCAy/view?usp=sharing
https://drive.google.com/file/d/1NGACv8KcPUnOyO2hY5ZOxRxPsXc9V6Gs/view?usp=sharing
https://drive.google.com/file/d/1dV6vQOAIHRRlVKbnnl1dlq8pjZrnGDaJ/view?usp=sharing
https://drive.google.com/file/d/1DzDfqsEPqTc_DwKeb3hyPaB7nT6XDKsc/view?usp=sharing
https://drive.google.com/file/d/1zyzlH1KXgwt3lFqw0UiUt8RklbmcN30s/view?usp=sharing
https://drive.google.com/file/d/1xvJurxc2nLfFp6TvgmZb1r525R-0TEkk/view?usp=sharing
https://drive.google.com/file/d/1jDvzBYkgK3WWlXbHEadmGW3yWn4AMRQw/view?usp=sharing
```
## Hints
1. What is the format of the link to the file itself?
2. How does Google know which file you're trying to download?
3. Where does the confirmation key come from?

## Solution
1. Players must first notice that Google Drive uses a specific path to download
any hosted file.
 * This path is specifically `https://drive.google.com/u/0/uc`, with the query
parameter `export=download`. This can be done by reading the link that is
associated with the first download button, found by just copying one of the
links above into a browser.
2. They then must notice that each file has a specific identifier associated to
it.
 * This identifier is found between `/d/` and `/view` in the links above.
 * ie. `https://drive.google.com/file/d/{identifier found here}/view?usp=sharing`
 * This key can be used with the path above within the query.
 * `https://drive.google.com/u/0/uc?export=download&id={identifier}`
3. Next, players need to notice that their download has been locked by Google,
requiring a confirmation key.
 * If done manually, players will arrive to a page where Google states they can
not scan the file for viruses. Thus, a user needs to click on the download
button to continue the download. 
 * Looking at the download button itself, it shows that there is an additional
query parameter `confim` with a seemingly random confirmation key everytime they
visit the page.
4. Then, players need to notice that, when accessing the link
`https://drive.google.com/u/0/uc?export=download&id={identifier}`, a cookie
is saved into the session, which matches the confirmation key. 
 * This cookie must exist when making a request with the confirmation key.
 * To do this, Python3's `requests` module is strongly recommended, specifically
using the `Session` object.
5. Once each a file has been downloaded, the file can be read and the string
pattern `magpie` can be searched for.
 * ~~This is probably a better way of doing it than in the solve script i posted whoops~~

## Flag
magpie{g00gl3_dr1v3_|)1v3}
