# Ret2jedi
### Category: Binary Exploitation
### Author: Brandon Arenas (Inga5508)

## Description
Obi-Wan extracted this vulnerable program from the Deathstar. Apparently, if you can exploit the local binary, you can hack the remote program inside the Deathstar!

## Hints
1. The program needs to be run twice. 
2. Leak the address of a function

## Solution

The challenge is a ROP challenge where the challenge is to build a stack using gadgets along with libc to execute a shell. The shell is built in two parts. The first is by leaking the address of \__libc_start_main with some ROP. The first stack should look like the following:

padding | pop_rdi | \__libc_start_main | puts | main

Where pop_rdi, \__libc_start_main, puts and main are all within the pwnable binary.

After successfully leaking the address of \__libc_start_main, the offset can be calculated off the libc library which the challenger has to find. This can be done by using the just leaked address on a libc database search to find the correct libc for the exploit. 

After finding the correct libc, you must update the offsets in the libc file using the leaked address by subtracting the leaked \__libc_start_main address from the \__libc_start_main address within the libc file.

Finally, after finding and updating the correct libc for the binary, the following stack should look like this:

padding + pop_rdi + binsh + system

Where binsh and system are found in libc. This final stack will spawn a shell.

1. Find minimum bytes to segfault
2. Using the provided libc, leak an address within the program
3. Within the same rop chain the address was leaked, run the program again (don't let it exit) by placing the address of main at the end of the first chain.
4. Update the libc with the leaked offset you found.
5. Find system and binsh within the program and build final rop chain payload

For detailed solution see exploit.py in solve/

## Flag
magpie{yo1_1_h@\/3_the_hi_gr0un(|!}
