# Flush
### Category: Binary Exploitation
### Author: steadmanticore

## Description
Bowser has kidnapped the princess and hidden her somewhere in the pipes. As an expert plumber, you must take on the challenge and rescue the princess. Hurry!

## Hints
1. https://linux.die.net/man/3/setvbuf
2. Never get trapped in a buffer – it’s a horrible existence

## Solution
Simple buffer overflow. 20 bytes of padding, then address of win, then address of some function that will force a buffer flush (exit plt, flush plt, or main), then 0xE91c, 0xb055, and 0xba771e. All content except the initial 20 bytes of padding are 32 bit integers written in little-endian form.

Biggest problem people will have is not setting a valid return address, which will cause a segfault and the flag will remain in the buffer and never be printed. However: local binaries should behave the same way, so if they can get it to work locally it should also work on the server.

## Flag
magpie{p21nc355_704d57001_<3_111}