FROM nsjailcontainer

ARG USERNAME=magpie
RUN useradd -m $USERNAME
RUN chmod a-w /home/$USERNAME

COPY finger_in_the_shell /home/magpie/finger_in_the_shell
COPY flag.txt /home/magpie/flag.txt

RUN chmod o+x /home/magpie/finger_in_the_shell

EXPOSE 6000

CMD ["/bin/nsjail",			\
        "-Ml",				\
        "--hostname", "host",		\
        "--port", "6000",		\
        "--user", "1001",		\
        "--group", "1001",          	\
        "--chroot", "/",		\
        "-E", "TERM=xterm",		\
        "--cwd", "/home/magpie",	\
        "--",				\
        "/home/magpie/finger_in_the_shell"	\
    ]
